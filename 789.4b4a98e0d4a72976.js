"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[789],{8789:(F,C,i)=>{i.r(C),i.d(C,{BoardDetailComponent:()=>$});var h=i(6814),e=i(6689),d=i(6040),m=i(1079),_=i(2806),c=i(4957),f=i(4921),u=i(7911),g=i(618),b=i(2572),p=i(2181),T=i(7398),B=i(4664),M=i(2096),k=i(9315),O=i(9862),A=i(5619),S=i(9647);const x={NX_CLI_SET:"true",NX_LOAD_DOT_ENV_FILES:"true",NX_WORKSPACE_ROOT:"/home/runner/work/v-notes/v-notes",NX_TERMINAL_OUTPUT_PATH:"/home/runner/work/v-notes/v-notes/node_modules/.cache/nx/terminalOutputs/10213959940750300679",NX_STREAM_OUTPUT:"true",NX_TASK_TARGET_PROJECT:"frontend",NX_TASK_TARGET_TARGET:"build",NX_TASK_TARGET_CONFIGURATION:"production",NX_TASK_HASH:"10213959940750300679"};let I=(()=>{var o;class l{constructor(){this._http=(0,e.f3M)(O.eN),this._socketService=(0,e.f3M)(_.$c),this._columnService=(0,e.f3M)(S.w),this.BOARD_API_URL=`${x.NX_API_URL}/boards`,this._currentBoardSubject$=new A.X(void 0),this.currentBoard$=this._currentBoardSubject$.asObservable()}fetchBoardById(t){return this._http.get(`${this.BOARD_API_URL}/${t}`)}setCurrentBoard(t){this._currentBoardSubject$.next(t)}leaveCurrentBoard(){this._currentBoardSubject$.next(null),this._columnService.setCurrentColumns(null),this._socketService.emit(c.tA.leaveBoard,{boardId:this._currentBoardSubject$.getValue()?.id??""})}}return(o=l).\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),l})();var D=i(3161),Z=i(7754),y=i(4913);let N=(()=>{var o;class l{transform(t,n=null){return n?t.filter(a=>a.boardColumn===n):[]}}return(o=l).\u0275fac=function(t){return new(t||o)},o.\u0275pipe=e.Yjl({name:"filterTasks",type:o,pure:!0,standalone:!0}),l})();const P=function(o){return{id:o}};function U(o,l){if(1&o&&(e.ynx(0),e.TgZ(1,"a",22)(2,"h4"),e._uU(3),e.qZA()(),e.BQk()),2&o){const s=l.$implicit,t=e.oxw(3);e.xp6(1),e.Q6J("routerLink","."+t.taskRoutes.task(e.VKq(2,P,s.id))),e.xp6(2),e.Oqu(s.title)}}function J(o,l){if(1&o){const s=e.EpF();e.TgZ(0,"span",15)(1,"div",16)(2,"v-notes-lib-inline-form",17),e.NdJ("valueSubmitted",function(n){const a=e.CHM(s).$implicit,v=e.oxw(2);return e.KtG(v.onUpdatedColumnNameSubmitted(n,a.id))}),e.qZA()(),e.TgZ(3,"div",18),e.YNc(4,U,4,4,"ng-container",19),e.ALo(5,"filterTasks"),e.TgZ(6,"v-notes-lib-inline-form",20),e.NdJ("valueSubmitted",function(n){const a=e.CHM(s).$implicit,v=e.oxw(2);return e.KtG(v.onTaskNameSubmitted(n,a.id))}),e.qZA()(),e.TgZ(7,"button",21),e.NdJ("click",function(){const r=e.CHM(s).$implicit,a=e.oxw(2);return e.KtG(a.onDeleteColumnClick(r.id))}),e._uU(8," Delete column "),e.qZA()()}if(2&o){const s=l.$implicit,t=e.oxw().ngIf;e.xp6(2),e.Q6J("formTitle",s.title),e.xp6(2),e.Q6J("ngForOf",e.xi3(5,2,t.tasks,s.id))}}function L(o,l){if(1&o){const s=e.EpF();e.ynx(0),e.TgZ(1,"div",8)(2,"v-notes-lib-inline-form",9),e.NdJ("valueSubmitted",function(n){e.CHM(s);const r=e.oxw();return e.KtG(r.onNewBoardTitleSubmitted(n))}),e.qZA(),e.TgZ(3,"cds-icon-button",10),e.NdJ("click",function(){const r=e.CHM(s).ngIf,a=e.oxw();return e.KtG(a.onDeleteBoardClick(r.currentBoard.id))}),e.O4$(),e._UZ(4,"svg",11),e.qZA()(),e.kcU(),e.TgZ(5,"div",12),e.YNc(6,J,9,5,"span",13),e.TgZ(7,"v-notes-lib-inline-form",14),e.NdJ("valueSubmitted",function(n){e.CHM(s);const r=e.oxw();return e.KtG(r.onColumnNameSubmitted(n))}),e.qZA()(),e.BQk()}if(2&o){const s=l.ngIf;e.xp6(2),e.Q6J("formTitle",s.currentBoard.title),e.xp6(4),e.Q6J("ngForOf",s.columns)}}let $=(()=>{var o;class l{constructor(){this._boardService=(0,e.f3M)(I),this._boardsService=(0,e.f3M)(D.E),this._route=(0,e.f3M)(m.gz),this._router=(0,e.f3M)(m.F0),this._socketService=(0,e.f3M)(_.$c),this._columnService=(0,e.f3M)(S.w),this._taskService=(0,e.f3M)(Z.M),this._authService=(0,e.f3M)(_.e8),this.taskRoutes=_.oL,this.boardId=null,this.deleteColumnModalState=(0,e.tdS)({isOpen:!1,columnId:null}),this.deleteBoardModalState=(0,e.tdS)({isOpen:!1,boardId:null}),this.data$=(0,b.a)([this._authService.currentUser$.pipe((0,p.h)(t=>!!t)),this._boardService.currentBoard$.pipe((0,p.h)(t=>!!t)),this._columnService.currentColumns$.pipe((0,p.h)(t=>!!t)),this._taskService.currentTasks$.pipe((0,p.h)(t=>!!t))]).pipe((0,d.sL)(),(0,T.U)(([t,n,r,a])=>({currentUser:t,currentBoard:n,columns:r,tasks:a}))),this._initializedListener()}ngOnDestroy(){this._boardService.leaveCurrentBoard()}ngOnInit(){this.boardId=this._route.snapshot.paramMap.get("id"),this._fetchData()}_fetchData(){const t=this.boardId;t?(this._boardService.fetchBoardById(t).subscribe({next:n=>{this._boardService.setCurrentBoard(n),this._socketService.emit(c.tA.joinBoard,{boardId:t})}}),this._columnService.fetchCurrentColumnsByBoardId(t).pipe((0,B.w)(n=>{this._columnService.setCurrentColumns(n);const r=n.map(a=>this._taskService.fetchCurrentTasksByColumnsId(a.id));return r.length?(0,k.D)(r):(0,M.of)([])})).subscribe({next:n=>{this._taskService.setCurrentTasks(n.reduce((r,a)=>[...r,...a],[]))}})):console.error("Missing board id in url parameter")}onNewBoardTitleSubmitted(t){this.boardId&&this._boardsService.updateBoard(this.boardId,t)}onColumnNameSubmitted(t){this.boardId?this._columnService.createColumn({boardId:this.boardId,columnTitle:t}):console.error("Missing board id in url parameter")}onUpdatedColumnNameSubmitted(t,n){this.boardId?this._columnService.updateColumn({boardId:this.boardId,columnId:n,columnTitle:t}):console.error("Missing board id in url parameter")}onTaskNameSubmitted(t,n){this.boardId?this._taskService.createTask({boardId:this.boardId,columnId:n,title:t}):console.error("Missing board id in url parameter")}onDeleteColumnClick(t){this.deleteColumnModalState.set({isOpen:!0,columnId:t})}onDeleteBoardClick(t){this.deleteBoardModalState.set({isOpen:!0,boardId:t})}onConfirmDeleteColumn(){const t=this.deleteColumnModalState().columnId;t&&this.boardId&&this._columnService.deleteColumn({boardId:this.boardId,columnId:t}),this.deleteColumnModalState.set({isOpen:!1,columnId:null})}onConfirmDeleteBoard(){const t=this.deleteBoardModalState().boardId;t&&this._boardsService.deleteBoard(t),this.deleteBoardModalState.set({isOpen:!1,boardId:null})}openModal(){this.deleteColumnModalState.update(t=>({...t,isOpen:!0}))}openDeleteBoardModal(){this.deleteBoardModalState.update(t=>({...t,isOpen:!0}))}closeModal(){this.deleteColumnModalState.update(t=>({...t,isOpen:!1}))}closeDeleteBoardModal(){this.deleteBoardModalState.update(t=>({...t,isOpen:!1}))}_initializedListener(){this._socketService.listen(c.tA.createColumnSuccess).pipe((0,d.sL)()).subscribe(({column:t})=>this._columnService.addToCurrentColumns(t)),this._socketService.listen(c.tA.createTaskSuccess).pipe((0,d.sL)()).subscribe(({task:t})=>{this._taskService.addToCurrentTasks(t)}),this._socketService.listen(c.tA.updateColumnSuccess).pipe((0,d.sL)()).subscribe(({column:t})=>{this._columnService.updateCurrentColumn(t)}),this._socketService.listen(c.tA.deleteColumnSuccess).pipe((0,d.sL)()).subscribe(({columnId:t})=>{this._columnService.removeFromCurrentColumns(t)}),this._socketService.listen(c.tA.deleteBoardSuccess).pipe((0,d.sL)()).subscribe(({boardId:t})=>{this._boardsService.removeFromCurrentUserBoards(t),this.boardId===t&&this._router.navigateByUrl(_.Dc.mainBoard)}),this._socketService.listen(c.tA.updateBoardSuccess).pipe((0,d.sL)()).subscribe(({board:t})=>{this._boardsService.updateOneInCurrentUserBoards(t),this._boardService.setCurrentBoard(t)}),this._socketService.listen(c.tA.updateTaskSuccess).pipe((0,d.sL)()).subscribe(({task:t})=>{this._taskService.updateOneInCurrentTasks(t)}),this._socketService.listen(c.tA.deleteTaskSuccess).pipe((0,d.sL)()).subscribe(({taskId:t})=>{this._taskService.removeOneInCurrentTasks(t)})}}return(o=l).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["v-notes-lib-board-detail"]],standalone:!0,features:[e.jDz],decls:33,vars:9,consts:[[4,"ngIf"],[3,"open","overlaySelected"],[3,"showCloseButton","closeSelect"],["cdsModalHeaderHeading",""],["cdsModalContent",""],["cdsModalContentText",""],["cdsButton","secondary",3,"click"],["cdsButton","danger--primary",3,"click"],[1,"title-container"],["placeHolder","Enter new title",3,"formTitle","valueSubmitted"],["kind","danger--primary","type","button",3,"click"],["cdsIcon","trash-can","size","16",1,"cds--btn__icon"],[1,"columns-container"],["class","column",4,"ngFor","ngForOf"],["formTitle","Enter column name",3,"valueSubmitted"],[1,"column"],[1,"column__title"],[3,"formTitle","valueSubmitted"],[1,"column__tasks-container"],[4,"ngFor","ngForOf"],["invalidText","","formTitle","Enter task name",3,"valueSubmitted"],["cdsButton","danger--primary",2,"align-self","flex-end",3,"click"],[1,"board",3,"routerLink"]],template:function(t,n){1&t&&(e.YNc(0,L,8,2,"ng-container",0),e.ALo(1,"async"),e._UZ(2,"router-outlet"),e.TgZ(3,"cds-modal",1),e.NdJ("overlaySelected",function(){return n.closeModal()}),e.TgZ(4,"cds-modal-header",2),e.NdJ("closeSelect",function(){return n.closeModal()}),e.TgZ(5,"h2",3),e._uU(6,"Confirmation"),e.qZA()(),e.TgZ(7,"section",4)(8,"h3"),e._uU(9,"Are you sure you want to delete this column?"),e.qZA(),e.TgZ(10,"p",5),e._uU(11," This will also delete all tasks associate with it and the action is irreversible "),e.qZA()(),e.TgZ(12,"cds-modal-footer"),e.ynx(13),e.TgZ(14,"button",6),e.NdJ("click",function(){return n.closeModal()}),e._uU(15," Cancel "),e.qZA(),e.TgZ(16,"button",7),e.NdJ("click",function(){return n.onConfirmDeleteColumn()}),e._uU(17," Confirm "),e.qZA(),e.BQk(),e.qZA()(),e.TgZ(18,"cds-modal",1),e.NdJ("overlaySelected",function(){return n.closeDeleteBoardModal()}),e.TgZ(19,"cds-modal-header",2),e.NdJ("closeSelect",function(){return n.closeDeleteBoardModal()}),e.TgZ(20,"h2",3),e._uU(21,"Confirmation"),e.qZA()(),e.TgZ(22,"section",4)(23,"h3"),e._uU(24,"Are you sure you want to delete this board?"),e.qZA(),e.TgZ(25,"p",5),e._uU(26," This will also delete all columns and tasks associate with it and the action is irreversible "),e.qZA()(),e.TgZ(27,"cds-modal-footer"),e.ynx(28),e.TgZ(29,"button",6),e.NdJ("click",function(){return n.closeDeleteBoardModal()}),e._uU(30," Cancel "),e.qZA(),e.TgZ(31,"button",7),e.NdJ("click",function(){return n.onConfirmDeleteBoard()}),e._uU(32," Confirm "),e.qZA(),e.BQk(),e.qZA()()),2&t&&(e.Q6J("ngIf",e.lcZ(1,7,n.data$)),e.xp6(3),e.Q6J("open",n.deleteColumnModalState().isOpen),e.xp6(1),e.Q6J("showCloseButton",!0),e.xp6(10),e.uIk("modal-primary-focus",!0),e.xp6(4),e.Q6J("open",n.deleteBoardModalState().isOpen),e.xp6(1),e.Q6J("showCloseButton",!0),e.xp6(10),e.uIk("modal-primary-focus",!0))},dependencies:[h.ez,h.sg,h.O5,h.Ov,y.A,N,f.hJ,f.zx,f.hU,u.zk,u.u_,u.xB,u.mz,u.hz,u.Ay,u.GE,g.QX,g.ar,m.Bz,m.lC,m.rH],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;padding:2.5rem;gap:.75rem}[_nghost-%COMP%]   .title-container[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .title-container[_ngcontent-%COMP%]     .inline-form__container{height:48px;background-color:#8a3ffc;color:#fff}[_nghost-%COMP%]   .columns-container[_ngcontent-%COMP%]{display:flex;gap:1rem}[_nghost-%COMP%]   .columns-container[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;padding:1rem;aspect-ratio:2/1;width:300px;background-color:#d0e2ff}[_nghost-%COMP%]   .columns-container[_ngcontent-%COMP%]   .column__title[_ngcontent-%COMP%]{margin-bottom:1.5rem}[_nghost-%COMP%]   .columns-container[_ngcontent-%COMP%]   .column__title[_ngcontent-%COMP%]     .inline-form__container{font-size:var(--cds-heading-05-font-size, 2rem);font-weight:var(--cds-heading-05-font-weight, 400);line-height:var(--cds-heading-05-line-height, 1.25);letter-spacing:var(--cds-heading-05-letter-spacing, 0);background-color:#a6c8ff;width:100%;height:80px}[_nghost-%COMP%]   .columns-container[_ngcontent-%COMP%]   .column__tasks-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}[_nghost-%COMP%]   .columns-container[_ngcontent-%COMP%]   .column__tasks-container[_ngcontent-%COMP%]     .inline-form__container{font-size:var(--cds-label-02-font-size, .875rem);font-weight:var(--cds-label-02-font-weight, 400);line-height:var(--cds-label-02-line-height, 1.28572);letter-spacing:var(--cds-label-02-letter-spacing, .16px);background-color:#edf5ff;width:100%;height:60px}"],changeDetection:0}),l})()}}]);